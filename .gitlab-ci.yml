# !!! Do not edit this file manually, see ci-generator folder !!!
test-ci-generator:
  stage: test
  image: python:3.7-alpine
  variables:
    PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"
  cache:
    paths:
      - .cache/pip
      - ci-generator/venv/
  before_script:
    - cd ci-generator
    - python -V
    - pip install virtualenv
    - virtualenv venv
    - source venv/bin/activate
    - pip install -r requirements.txt
  script:
    - coverage run -m unittest tests/test*.py
    - coverage report
    - coverage html
  coverage: '/^TOTAL.*\s+(\d+\%)$/'
  artifacts:
    paths:
      - ci-generator/htmlcov

variables:
  # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
  # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
  DOCKER_DRIVER: overlay2
  DOCKER_TLS_CERTDIR: "/certs"

image: docker:19.03.2

services:
  - docker:19.03.2-dind

stages:
  - test
  - prepare
  - build

before_script:
  - docker login -u "$CI_REGISTRY_USER" -p "$CI_REGISTRY_PASSWORD" $CI_REGISTRY

.build: &build
  stage : build
  script:
    - ci/build.sh
  retry: 2








# platform specific for 2019.3.5f1: linux-il2cpp
unity_2019_3_5f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.5
    BUILD: f1
    TAG: 2019.3.5f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/d691e07d38ef/UnitySetup-2019.3.5f1
    BASE_IMAGE: gableroux/unity3d:2019.3.5f1
    SHA1: 8bc329d54a5ec36d1786d3aee78995caafd53f1b
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.5f1
    RELEASE_URL: https://beta.unity3d.com/download/d691e07d38ef/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2020.1.0b2: linux-il2cpp
unity_2020_1_0b2-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2020.1.0
    BUILD: b2
    TAG: 2020.1.0b2-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/14d43bf8b596/UnitySetup-2020.1.0b2
    BASE_IMAGE: gableroux/unity3d:2020.1.0b2
    SHA1: 6997576c84045c8caf26465fb93bb47286cf419c
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2020.1.0b2
    RELEASE_URL: https://beta.unity3d.com/download/14d43bf8b596/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.0f1: linux-il2cpp
unity_2019_3_0f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.0
    BUILD: f1
    TAG: 2019.3.0f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/ffacea4b84e7/UnitySetup-2019.3.0f1
    BASE_IMAGE: gableroux/unity3d:2019.3.0f1
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.0f1
    RELEASE_URL: https://beta.unity3d.com/download/ffacea4b84e7/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.0f6: linux-il2cpp
unity_2019_3_0f6-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.0
    BUILD: f6
    TAG: 2019.3.0f6-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/27ab2135bccf/UnitySetup-2019.3.0f6
    BASE_IMAGE: gableroux/unity3d:2019.3.0f6
    SHA1: 9872ec78b9d0ec29366af52a01587cee1d03377f
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.0f6
    RELEASE_URL: https://beta.unity3d.com/download/27ab2135bccf/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.1f1: linux-il2cpp
unity_2019_3_1f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.1
    BUILD: f1
    TAG: 2019.3.1f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/89d6087839c2/UnitySetup-2019.3.1f1
    BASE_IMAGE: gableroux/unity3d:2019.3.1f1
    SHA1: e963ddd0efc8833dac8e5fc80038d4f7787aba97
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.1f1
    RELEASE_URL: https://beta.unity3d.com/download/89d6087839c2/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.2f1: linux-il2cpp
unity_2019_3_2f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.2
    BUILD: f1
    TAG: 2019.3.2f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/c46a3a38511e/UnitySetup-2019.3.2f1
    BASE_IMAGE: gableroux/unity3d:2019.3.2f1
    SHA1: dc99638b8b4aca3b5b7fc2d1a852b85c11deb11f
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.2f1
    RELEASE_URL: https://beta.unity3d.com/download/c46a3a38511e/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.3f1: linux-il2cpp
unity_2019_3_3f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.3
    BUILD: f1
    TAG: 2019.3.3f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/7ceaae5f7503/UnitySetup-2019.3.3f1
    BASE_IMAGE: gableroux/unity3d:2019.3.3f1
    SHA1: 68d3c58e977e71cdd00bd0100fcd60c02762ec04
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.3f1
    RELEASE_URL: https://beta.unity3d.com/download/7ceaae5f7503/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.6f1: linux-il2cpp
unity_2019_3_6f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.6
    BUILD: f1
    TAG: 2019.3.6f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/5c3fb0a11183/UnitySetup-2019.3.6f1
    BASE_IMAGE: gableroux/unity3d:2019.3.6f1
    SHA1: f6bfc5f5f1174b0f937128854aad6759a8524c13
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.6f1
    RELEASE_URL: https://beta.unity3d.com/download/5c3fb0a11183/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2020.1.0b3: linux-il2cpp
unity_2020_1_0b3-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2020.1.0
    BUILD: b3
    TAG: 2020.1.0b3-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/6955a944264e/UnitySetup-2020.1.0b3
    BASE_IMAGE: gableroux/unity3d:2020.1.0b3
    SHA1: 1530c0265a01f8b9ac925b14383d1afba33bcc2a
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2020.1.0b3
    RELEASE_URL: https://beta.unity3d.com/download/6955a944264e/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2018.4.20f1: linux-il2cpp
unity_2018_4_20f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2018.4.20
    BUILD: f1
    TAG: 2018.4.20f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/008688490035/UnitySetup-2018.4.20f1
    BASE_IMAGE: gableroux/unity3d:2018.4.20f1
    SHA1: 2c303d964744bc75c0571da63ae417a8ed7b33a1
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2018.4.20f1
    RELEASE_URL: https://beta.unity3d.com/download/008688490035/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"










# platform specific for 2019.3.7f1: linux-il2cpp
unity_2019_3_7f1-linux-il2cpp:
  <<: *build
  variables:
    DOCKERFILE_NAME: unitysetup-linux-il2cpp
    VERSION: 2019.3.7
    BUILD: f1
    TAG: 2019.3.7f1-linux-il2cpp
    COMPONENTS: Linux-IL2CPP
    DOWNLOAD_URL: https://beta.unity3d.com/download/6437fd74d35d/UnitySetup-2019.3.7f1
    BASE_IMAGE: gableroux/unity3d:2019.3.7f1
    SHA1: 4845b7bd6e3d1df813da2be5c1fa580d0c2855ad
    RELEASE_NOTES: https://unity3d.com/unity/whats-new/2019.3.7f1
    RELEASE_URL: https://beta.unity3d.com/download/6437fd74d35d/public_download.html
    # https://about.gitlab.com/2019/07/31/docker-in-docker-with-docker-19-dot-03/
    # https://gitlab.com/gitlab-org/gitlab-runner/issues/4501
    DOCKER_DRIVER: overlay2
    DOCKER_TLS_CERTDIR: "/certs"




